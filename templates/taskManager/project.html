{% extends 'base.html' %}
{% block title %}
{{project}}
{% endblock title %}
{% block base %}

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
  integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">

<style>
  @import url('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css');

  .sticky-icon-bar {
    position: fixed;
    top: 50%;
    box-shadow: 5px 0 20px rgba(0, 0, 0, 0.4);
    transform: translateY(-50%);
  }
   .text-send{
    bottom:0px;
   }

  .sticky-message-bar {
    position: fixed;
    top: 50%;
    right:0%;
    height: 70vh;
    box-shadow: 5px 0 20px rgba(0, 0, 0, 0.4);
    transform: translateX(-4%);
  }

  .sticky-icon-bar a {
    display: block;
    text-align: center;
    padding: 16px;
    transition: all 0.3s ease;
    color: #333;
    font-size: 20px;
    background-color: #ffffff;
  }

  .sticky-icon-bar a:hover {
    background-color: #333;
    color: white;
  }

  .text {
    margin: 80px;
    font-size: 28px;
    text-align: justify;
  }
  .modal-dialog {
    display: flex;
    align-items: center;
    min-height: calc(100% - 1rem);
  }
</style>


<!-- header  -->
<div class='container'>
  <div class="row">
    <div class="col-sm-7">
      <h1 class="container">{{project}}
        <span class="badge">
          <button type="button" class="btn btn-outline-primary" data-toggle="modal" data-target="#exampleModal">
            Detail
          </button>
        </span>
      </h1>

    </div>
    <div class="col-sm-4">
      <small>
        <strong>Representative: </strong><a href="#">{{project.representative}}</a><br>
        <strong>Members: </strong>
        {% for member in project.members.all %}
        <a href="{% url 'profile' member.id %}">{{ member.username }}</a>,
        {% endfor %}
        <br>
        <strong>Deadline: </strong>{{project.deadline}}
      </small>
      <br>
    </div>
    <div class="col-sm-1 float-right">
      <a class="btn btn-outline-primary" data-bs-toggle="offcanvas" href="#offcanvasExample" role="button"
        aria-controls="offcanvasExample">
        Link/Media
      </a>
    </div>
  </div>
</div>
<hr>
<!-- end of header -->



<div class="row">
  <!-- sidebar -->
  <div class="col-sm-1">
    <div class="sticky-icon-bar">
      <a href="https://codepen.io/lenasta92579651" class="codepen"><i class="fab fa-codepen"></i></a>
      <a href="https://twitter.com/lenasta92579651" class="twitter"><i class="fab fa-twitter"></i></a>
      <a href="https://www.instagram.com/stanleylenablog/" class="instagram"><i class="fab fa-instagram"></i></a>
      <a href="https://www.youtube.com/channel/UCMtOSqCHykGR3ATq5nwBhSw?view_as=subscriber" class="youtube"><i
          class="fab fa-youtube"></i></a>
    </div>
  </div>
  <!-- task list portion -->
  <div class="col-sm-8">
    <!-- task list  -->
    <!-- task count and add task button -->
    <div class="container text-right">
      <small>
        <strong>Tasks: </strong> {{task_completed}}/{{total_task}}
        <a class="btn btn-sm btn-primary" href="{% url 'addTask' project.id %}"><strong>+</strong>Task</a>
      </small>
    </div>
    <!-- end of task count and add task button -->
    <br>
    <div class="container" style="width: 60vw;">
      {% for task in task %}
      <div class="card text-left shadow">
        <div class="card-header text-white bg-{{task.theme}}">
          <div class="row">
            <div class="col-sm-7">
                <div style="float: left;">
                    <span>{{forloop.counter}}.</span>
                </div>
                <div style="float: left; margin-left: 10px;">
                    {{task.title | safe}}
            </div>
            
            </div>
            <div class="col-sm-3">
              
              <a style="color: #ffffff;" type="button" data-toggle="modal" data-target="#{{task.id}}">
                <i class="fa fa-info-circle" aria-hidden="true"></i>
              </a>
              <!--  modal -->
              <div class="modal fade text-dark" id="{{task.id}}" tabindex="-1" role="dialog" aria-labelledby="{{task.id}}Label">
                <div class="modal-dialog" role="document">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h4 class="modal-title" id="{{task.id}}Label"><strong>Task:</strong> {{task.title | safe}}</h4>
                    </div>
                    <div class="modal-body">
                      <strong>Detail</strong> {{task.description | safe}}
                      <br>
                      <strong>Credit:</strong> {{task.credits}}
                      <br>
                      <strong>Created by: </strong> {{task.created_by}}
                      <br>
                      <strong>Created on: </strong> {{task.created}}
                      <br>
                      <strong>Deadline: </strong> {{task.deadline}}

                    </div>

                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                  </div>
                </div>
              </div>
              <!-- end of modal -->

              &nbsp;
              <a style="color: #ffffff;" href="#">
                <i class="fa fa-comments" aria-hidden="true"></i>
              </a>
            </div>
            <div class="col-sm-1">
              <input class="form-check-input" type="checkbox" name="" id="">
            </div>
          </div>
        </div>
        {% if task.subtasks %}
        <div class="card-body">
          {% for obj in task.subtasks %}
          <div class="row">
            <div class="col-sm-8">
              <p class="card-text">{{forloop.counter}}.{{obj}}</p>
            </div>
            <div class="col-sm-3 text-primary">
              <a  type="button" data-toggle="modal" data-target="#{{obj.title}}">
                <i class="fa fa-info-circle" aria-hidden="true"></i>
              </a>
              <!--  modal -->
              <div class="modal fade text-dark" id="{{obj.title}}" tabindex="-1" role="dialog" aria-labelledby="{{obj.title}}Label">
                <div class="modal-dialog" role="document">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h4 class="modal-title" id="{{obj.title}}Label"><strong>SubTask:</strong> {{obj | safe}}</h4>
                    </div>
                    <div class="modal-body">
                      <strong>Detail</strong> {{obj.description | safe}}
                      <br>
                      <strong>Credit:</strong> {{obj.credits}}
                      <br>
                      <strong>Created by: </strong> {{obj.created_by}}
                      <br>
                      <strong>Created on: </strong> {{obj.created}}
                      <br>
                      <strong>Deadline: </strong> {{obj.deadline}}

                    </div>

                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                  </div>
                </div>
              </div>
              <!-- end of modal -->

              &nbsp;
              <a  href="#">
                <i class="fa fa-comments" aria-hidden="true"></i>
              </a>
              &nbsp;


            </div>
            <div class="col-sm-1">
              <input class="form-check-input border-primary" type="checkbox" name="" id="">
            </div>
          </div>
          {% endfor %}
        </div>
        {% endif %}

        <div class="card-footer text-muted row">
          <div class="col-sm-6">
            <strong>Remaining: </strong>{{task.remaining_time}}
          </div>
          <div class="col-sm-6 text-right">
            <a class="btn btn-outline-dark btn-sm" href="#">Comment & Update</a>
            <a class="btn btn-outline-{{task.theme}} btn-sm" href="#">Update</a>
          </div>
        </div>
      </div>
      <br>
      {% endfor %}
    </div>
    <!-- end of task list -->

  </div>


  <!-- messages -->
  <div class="col-sm-3 bg-light rounded-md shadow sticky-message-bar border border-3 rounded">
    {% comment %} <div class="vr"></div> {% endcomment %}
    <center><strong class="bg-primary text-white rounded p-2">Messages:</strong></center>
    <hr>

    <div class="overflow-auto" style="max-height: 350px;" id="small-screen-container">
      <!-- Small screen content goes here -->
      
      {% for msg in msg %}
        <div class="card">
          <div class="card-header"><strong>{{msg.sender}}</strong>
          <small>{{msg.created}}</small> 
          </div>
          <div class="card-body">
            <p>{{msg.body}}</p>
          </div>
        </div>
      {% endfor %}
    </div>

    <div class="text-send">
    <hr>
    <div class="text-right">
      <div class="input-group mb-3">
        <input type="text" class="form-control" placeholder="Text..." aria-label="Recipient's username" aria-describedby="basic-addon2">
        <span class="input-group-text" id="basic-addon2">
          <input class="btn btn-dark" type="button" value="Send">
        </span>
      </div>
      &nbsp;&nbsp;&nbsp;&nbsp;
    </div>
  </div>

    <br>
  </div>
  <!-- end of messages  -->
</div>

<!-- links and media Offcanvas -->
<div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasExample" aria-labelledby="offcanvasExampleLabel">
  <div class="offcanvas-header">
    <button type="button" class="btn-close me-left" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <div class="offcanvas-body">
    <!-- Offcanvas content -->
    <div class="container">
      <ul class="nav nav-tabs">
        <li class="nav-item">
          <a class="nav-link active" data-toggle="tab" href="#links">Links</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" data-toggle="tab" href="#media">Media</a>
        </li>
      </ul>

      <div class="tab-content">
        <div id="links" class="tab-pane fade show active">


          <h3>Links</h3>
          <p>This is the Links tab.</p>
        </div>
        <div id="media" class="tab-pane fade">


          <h3>Media</h3>
          <p>This is the Media tab.</p>
        </div>
      </div>
    </div>

  </div>
</div>
<!-- end of links and media Offcanvas -->



<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Project detail</h1>
      </div>
      <div class="modal-body">
        <dl>
          <dt>Project Name: </dt>
          <dd>{{project.name}}</dd>
          <dt>Deadline: </dt>
          <dd>{{project.deadline}}</dd>
          <dt>Created on: </dt>
          <dd>{{project.created}}</dd>
          <dt>Representative: </dt>
          <dd>{{project.representative}}</dd>
          <dt>Tasks Remaining: </dt>
          <dd>{{task_remaining}}</dd>
          <dt>Tasks Completed: </dt>
          <dd>{{task_completed}}</dd>
          <dt>Total Tasks: </dt>
          <dd>{{total_task}}</dd>
          <dt>Members: </dt>
          <dd>{{project.members}}</dd>
          <dt>Project Description: </dt>
          <dd>{{project.description}}</dd>

        </dl>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary">Edit</button>
      </div>
    </div>
  </div>
</div>
<!-- end of Modal -->


<script>
  // Get the small screen container element
  const smallScreenContainer = document.getElementById("small-screen-container");

  // Scroll to the bottom of the container after the page has finished loading
  window.addEventListener("load", function () {
    smallScreenContainer.scrollTop = smallScreenContainer.scrollHeight;
  });
</script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
  integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"
  integrity="sha384-mQ93GR66B00ZXjt0YO5KlohRA5SY2XofN4zfuZxLkoj1gXtW8ANNCe9d5Y3eG5eD" crossorigin="anonymous"></script>
{% endblock base %}